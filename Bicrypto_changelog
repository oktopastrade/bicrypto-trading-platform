Update Notes - Core 5.7.1
Update Notes
Fixed




Binary Options Trading
• Investment Return on Wins: Fixed critical issue where winning trades only returned profit without the original investment
• Users were losing their investment amount on every winning trade
• Example: $100 investment with 87% profit should return $187, but only returned $87
• Balance calculations now correctly return investment + profit on winning trades
• Applies to all trading modes (demo and real)
• Profit Percentage Configuration: Fixed hardcoded 88% profit being used instead of configured duration-specific percentages
• System was ignoring admin-configured profit percentages in binary_duration table
• All durations showed 88% profit regardless of settings
• Profit percentages now dynamically loaded from database per duration
• Admins can now customize profit percentages for each time duration (1min, 5min, 15min, etc.)
• Profit percentage properly stored with each order for historical accuracy




P2P Trading
• Database Schema: Fixed "Can't create table p2p_trades (errno: 150 'Foreign key constraint is incorrectly formed')" error
• Root cause: Type mismatch between paymentMethod field (VARCHAR) and payment method ID reference (UUID)
• Updated paymentMethod field to use UUID type for proper foreign key constraint
• Enables proper relationship between trades and payment methods




Migration Notes




Database Migration Required


IMPORTANT: This update requires dropping and recreating the p2p_trades table due to schema changes.

Steps to perform migration:

Backup your database before proceeding
Run the following SQL commands (or use phpMyAdmin):
   ``sql

   SET FOREIGN_KEY_CHECKS = 0;

   DROP TABLE IF EXISTS p2p_trades;

   SET FOREIGN_KEY_CHECKS = 1;

   `

Alternative (phpMyAdmin):
• Open phpMyAdmin and select your database
• Find the p2p_trades table in the table list and click "Drop"
• When the confirmation dialog appears, uncheck the "Enable foreign key checks" checkbox
• Click "Yes" to confirm the drop operation
• Repeat for p2p_disputes and p2p_reviews` tables
Restart your backend application
The tables will be recreated automatically with the correct schema


Note: This migration will delete all existing P2P trades, disputes, and reviews.
